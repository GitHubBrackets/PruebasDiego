function restExec(a){var b={service:a.service,data:a.data||{},async:a.async||!1,success:a.success||rest_fnNothig,error:a.error||rest_fnShowError,showWait:a.showWait||!1,finallySuccess:a.finallySuccess||rest_fnNothig,finallyError:a.finallyError||rest_fnNothig},c=b.showWait?SCONFIG.getMessage("wait"):void 0;writeLog("datos a enviar: ",b.data),writeLog("string ",JSON.stringify(b.data)),rest_execute=function(){$.ajax({type:"POST",dataType:"json",contentType:"application/json; charset=utf-8",url:SCONFIG.get(b.service),data:JSON.stringify(b.data),async:b.async,cache:!1,success:function(a){writeLog("RESPUESTA "+b.service,a),b.showWait&&$("#"+SCONFIG.getMessage("wait").idModal).modal("hide"),b.success(a),b.finallySuccess(a)},error:function(a){return writeLog("ERROR EN SERVICIO "+b.service,a),"undefined"!=typeof a.responseText&&-1!=a.responseText.indexOf("<title>Login</title>")?void location.reload():void(b.showWait&&$("#"+SCONFIG.getMessage("wait").idModal).modal("hide"),b.error(a),b.finallyError(a))}})},b.showWait?($("#"+c.idModal).modal(),a.customWait?rest_fnShowWait({idModal:c.idModal,title:a.customWait.title,message:a.customWait.message}):rest_fnShowWait(c),setTimeout(function(){rest_execute()},400)):(writeLog("else"),rest_execute())}var rest_fnNothig=function(){writeLog("nothing")},rest_fnShowError=function(a){return modal=SCONFIG.getMessage("error"),showModals(modal.title,modal.message,modal.idModal),"undefined"==typeof a.responseJSON&&(a.responseJSON={message:"SIN DETALLE DEL ERROR"}),spn=$("<small></small>").text(a.responseJSON.message),pAlert=$("#"+modal.idModal).find("p.alert-danger"),0==pAlert.length?$("#"+modal.idModal).find("p").after($("<p></p>").addClass("alert alert-danger").append(spn)):pAlert.html(spn),void("No tienes privilegios para accesar"==a.responseJSON.message&&$("#"+SCONFIG.getMessage("error").idModal).find("button").on("click",function(){location.reload()}))},rest_fnShowWait=function(a){showModals(a.title,a.message,a.idModal)},rest_fnAverageQuery=function(a){writeLog("Average Query"),writeLog(a),scholar.statusQualifications.averagesSchoolGrade=a.averagesScholarLevel,scholar.statusQualifications.constancyNextGrade=a.constancyNextGrade,scholar.statusQualifications.indicatorMissingConstancy=a.indicatorMissingConstancy},rest_fnConsultLevelGrade=function(a){writeLog("Consult Level & Grade"),scholar.statusQualifications.schoolLevels=a.schoolLevels},rest_fnDepositModification=function(a){writeLog("Deposit Modification"),writeLog(a)},rest_fnDepositQuery=function(a){for(var b in writeLog("Deposit Query"),writeLog(a),a.student[0].confirmDisp)"Pendiente"==a.student[0].confirmDisp[b].statusScholarshipReceived?scholar.confirm.push({idMonth:a.student[0].confirmDisp[b].monthConfirm+""+a.student[0].confirmDisp[b].yearConfirm,month:a.student[0].confirmDisp[b].monthConfirm,year:a.student[0].confirmDisp[b].yearConfirm}):scholar.scholarship.confirmDispersion.push(a.student[0].confirmDisp[b])},rest_fnDetailsScholar=function(a){writeLog("Detail Scholar"),writeLog(a),scholar.studentID=a.student[0].studentID,scholar.personalData.username=a.userScholar,scholar.personalData.name=a.student[0].name,scholar.personalData.lastName=a.student[0].firstName,scholar.personalData.secondLastName=a.student[0].lastName,scholar.personalData.originRegion=a.student[0].originRegion,scholar.personalData.originState=a.student[0].originState,scholar.personalData.cdOriginState=a.student[0].cdOriginState,scholar.personalData.originMunicipality=a.student[0].originMunicipality,scholar.personalData.cdOriginMunicipality=a.student[0].cdOriginMunicipality,scholar.personalData.curp=a.student[0].CURP,scholar.personalData.birthdate=a.student[0].scholarBirthdate,scholar.personalData.age=a.student[0].age,scholar.personalData.gender=a.student[0].gender,scholar.personalData.assignedCR=a.student[0].assignedCR,scholar.personalData.cdAssignedCR=a.student[0].cdAssignedCR,scholar.personalData.scholarNumber=a.student[0].scholarNumber,scholar.personalData.accountNumber=a.student[0].accountNumber,scholar.personalData.profilePicture=a.student[0].folioPhoto,scholar.scholarship.statusDispersion=a.student[0].statusDispersion,scholar.scholarship.programName=a.student[0].programName,scholar.scholarship.programType=a.student[0].programKey,scholar.scholarship.modalityParticipation=a.student[0].programScholar[0].modalityParticipation,scholar.schoolData.name=a.student[0].schoolData[0].school[0].name,scholar.schoolData.domicile=a.student[0].schoolData[0].school[0].domicile,scholar.schoolData.type=a.student[0].schoolData[0].school[0].type,scholar.schoolData.initials=a.student[0].schoolData[0].school[0].initials,scholar.schoolData.control=a.student[0].schoolData[0].school[0].control,scholar.schoolData.cct=a.student[0].schoolData[0].school[0].CCT,scholar.schoolData.state=a.student[0].schoolData[0].school[0].state,scholar.schoolData.cdState=a.student[0].schoolData[0].school[0].cdState,scholar.schoolData.municipality=a.student[0].schoolData[0].school[0].municipality.trim(),scholar.schoolData.cdMunicipality=a.student[0].schoolData[0].school[0].cdMunicipality,scholar.schoolData.typeCareer=a.student[0].schoolData[0].typeCareer,scholar.schoolData.nameCareer=a.student[0].schoolData[0].nameCareer,scholar.schoolData.area=a.student[0].schoolData[0].area,scholar.schoolData.turn=a.student[0].schoolData[0].turn,scholar.schoolData.duration=a.student[0].schoolData[0].duration,scholar.domicile=a.student[0].domicile[0],scholar.contactData=a.student[0].contactInf[0],scholar.statusQualifications.schoolGrade=a.student[0].programScholar[0].schoolGrade,scholar.statusQualifications.schoolCycle=a.student[0].schoolCycle,scholar.tutorData.name=a.student[0].tutorData[0].tutorName,scholar.tutorData.lastName=a.student[0].tutorData[0].firstNameTutor,scholar.tutorData.secondLastName=a.student[0].tutorData[0].lastaNameTutor,scholar.tutorData.kinship=a.student[0].tutorData[0].kinship,scholar.tutorData.kinshipType=a.student[0].tutorData[0].kinshipType,scholar.program=a.student[0].programScholar},rest_fnModifUploadScholar=function(){writeLog("Modif & Upload Scholar"),restExec({service:"DETAILS_SCHOLAR",data:{userScholar:scholar.personalData.username},success:rest_fnDetailsScholar})},rest_fnQualificationQuery=function(a){writeLog("Qualification Query",a),scholar.statusQualifications.averagesScholarLevel=[],scholar.statusQualifications.schoolLevels.forEach(function(b){b.scholarGrades.forEach(function(c){for(i=0;20>i;i++)a.qualifications&&a.qualifications.forEach(function(a){a.scholarLevel==b.scholarLevel&&c.scholarGrade==a.schoolGrade&&a.schoolPeriod.substring(0,i.toString().length)==i.toString()&&(a.isMissing=!1,scholar.statusQualifications.averagesScholarLevel.push(a))}),a.missingQualifications&&a.missingQualifications.forEach(function(a){a.scholarLevel==b.scholarLevel&&c.scholarGrade==a.schoolGrade&&a.schoolPeriod.substring(0,i.toString().length)==i.toString()&&(a.isMissing=!0,a.folio="",scholar.statusQualifications.averagesScholarLevel.push(a))})})})},rest_fnUpdateQualification=function(a){writeLog("Update Qualification"),writeLog(a),scholar.statusQualifications.averageSchoolGrade=a.qualification},rest_fnValidationScholar=function(a){writeLog("Validation Scholar"),writeLog(a)},rest_fnConsultParameters=function(a){switch(writeLog("rest_fnConsultParameters",a.parameters[0].parameterType),a.parameters[0].parameterType){case"SX":for(var b in a.parameters)combos.gender[b]=a.parameters[b].parameterDescription;break;case"PAREN":for(var b in a.parameters)combos.kindship[b]=a.parameters[b].parameterDescription;break;case"TPVIA":for(var b in a.parameters)combos.typeOfViality[b]=a.parameters[b].parameterDescription;break;case"CDRB":for(var b in writeLog("Entra a CDRB"),a.parameters)combos.cdRB[b]=a.parameters[b].parameterDescription,writeLog(a.parameters[b].parameterDescription);}},rest_fnUploadedPhoto=function(a,b){writeLog("rest_fnUploadedPhoto",a),restExec({service:"GET_DOCUMENT",async:!b,data:{aplicationName:"BECAS",listReferenceNumber:[a.folio],features:[{id:"opcion",name:"base64"}]},error:function(a){console.error("Error al consultar foto ",a)},success:function(a){"undefined"!=typeof a.listDocuments[0]&&"undefined"!=typeof a.listDocuments[0].document&&"undefined"!=typeof a.listDocuments[0].document.data&&(writeLog("GET_DOCUMENT",a),scholar.personalData.base64ProfilePicture="data:image/jpeg;base64,"+a.listDocuments[0].document.data,!b&&fn_loadProfilePicture())}})},pre_fnSendDocument=function(a){tDoc=a.typeDocument.split("|"),restExec({service:"SEND_DOCUMENT",showWait:!0,customWait:{title:"Guardando tu foto de perfil",message:"Espera un momento por favor"},data:{imagen:{moduleIndicator:a.moduleIndicator,studentID:scholar.studentID,programType:scholar.scholarship.programType,typeDocument:a.typeDocument,schoolGrade:scholar.statusQualifications.schoolGrade,schoolCycle:scholar.statusQualifications.schoolCycle,schoolPeriod:"",userCurrent:scholar.studentID},archiving:{aplicationName:"becas",features:[{id:"numeroCliente",name:scholar.personalData.scholarNumber},{id:"numeroCuenta",name:scholar.personalData.accountNumber+""},{id:"cr",name:scholar.personalData.cdAssignedCR+""},{id:"nombreBeca",name:scholar.scholarship.programType},{id:"nombreDoc",name:tDoc[1]},{id:"cveDoc",name:tDoc[0]},{id:"ciclo",name:scholar.statusQualifications.schoolCycle},{id:"extension",name:a.ext},{id:"nombreArchivo",name:a.filename},{id:"usuario",name:scholar.studentID+""},{id:"primera",name:"true"},{id:"ultima",name:"true"}],document:{data:a.base64}}},success:function(a){rest_fnUploadedPhoto(a,!1)},finallyError:function(a){writeLog("error ",a)},finallySuccess:function(){showModals("Tu foto se ha cargado satisfacotiamente","Gracias por la espera","savedFile")}})},pre_fnSendMultiDocument=function(a){tDoc=a.typeDocument.split("|"),restExec({service:"SEND_MULT_DOCUMENT",data:{aplicationName:"becas",features:[{id:"numeroCliente",name:scholar.personalData.scholarNumber},{id:"numeroCuenta",name:scholar.personalData.accountNumber+""},{id:"cr",name:scholar.personalData.cdAssignedCR},{id:"nombreBeca",name:scholar.scholarship.programType},{id:"nombreDoc",name:tDoc[1]},{id:"cveDoc",name:tDoc[0]},{id:"ciclo",name:scholar.statusQualifications.schoolCycle},{id:"extension",name:a.ext},{id:"nombreArchivo",name:a.filename},{id:"usuario",name:scholar.studentID+""},{id:"primera",name:a.first},{id:"ultima",name:a.last}],document:{data:a.base64}},success:a.success,error:a.error})},pre_fnloadFile=function(a){$("#show_file").attr("src",SCONFIG.getVisor(a)),$("#consultFiles").modal("show")},rest_reloadQualifications=function(){restExec({service:"QUALIFICATION_QUERY",async:!1,data:{studentID:scholar.studentID,scholarLevel:"",schoolGrade:"",schoolPeriod:""},success:rest_fnQualificationQuery,error:rest_fnNothig})},rest_averageQuery=function(){restExec({service:"AVERAGE_QUERY",async:!1,data:{studentID:scholar.studentID,scholarLevel:"",schoolGrade:""},success:rest_fnAverageQuery})},rest_fnAlerts=function(a){scholar.alerts=a.alertMessages,writeLog("guarda alertas: ",a.alertMessages)},rest_fnStates=function(a){statesTransactions=a.stateTransactions},rest_getMunicipality=function(a){restExec({service:"GET_MUNICIPALITY",showWait:!0,customWait:{title:"Consultando datos",message:"Por favor espera"},data:{state:a},success:fn_listMunicipality})},rest_fnUpdatePassword=function(a){writeLog("rest_fnUpdatePassword"),writeLog(a);var b={responseJSON:{message:a.statusDescription+"."},serviceName:a.statusCode};"MDO_000"==a.statusCode?(showModals("Tu contrase\xF1a se ha actualizado correctamente","","savedFile"),$("#btnCancelsChangePassword").click()):"MDO_003"==a.statusCode||"MDO_008"==a.statusCode||"MDO_013"==a.statusCode||"MDO_015"==a.statusCode||"MDO_017"==a.statusCode||"MDO_020"==a.statusCode||"MDO_021"==a.statusCode?rest_fnShowError(b):rest_fnShowError("Ocurri\xF3 un problema, por favor intentalo m\xE1s tarde")};