dojoConfig={isDebug:!0,parseOnLoad:!1},dojo.require("dijit._Templated"),dojo.require("dojo.fx");var app_conf={writeLog:!1},servOrigin=window.location.origin;(-1!=servOrigin.indexOf("localhost")||-1!=servOrigin.indexOf("150.250.238.172")||-1!=servOrigin.indexOf("150.250.238.173"))&&(app_conf.writeLog=!0);var writeLog=function(){try{app_conf.writeLog&&console.log.apply(this,writeLog.arguments)}catch(a){}};function loadTemplate(a,b,c){if(!b)return void console.error("loadTemplate: templateData is undefined ["+a+"]");if(strTemplate=dojo.cache(b.workspace,b.html),!c)console.warn("loadTemplate: data is null ["+b.html+"]");else if(varsTemplate=strTemplate.match(/\u0024\u007B[a-zA-Z0-9_]*\u007D/g),varsTemplate)for(it=0;it<varsTemplate.length;it++)varsTemplate[it].substring(2,varsTemplate[it].length-1),tempData=varsTemplate[it],nameData=tempData.substring(2,tempData.length-1),"undefined"==typeof c[nameData]?console.warn("loadTemplate: "+nameData+" is null ["+b.html+"]"):strTemplate=strTemplate.replace(tempData,c[nameData]);return node=dojo.byId(a),node?void(node.innerHTML=strTemplate,b.onload()):void console.error("loadTemplate: Node "+a+" doesn't exist ["+b.html+"]")}function getRootPath(){return _url=window.location.href,"#"===_url.charAt(_url.length-1)&&(_url=_url.substring(0,_url.length-1)),"/"===_url.charAt(_url.length-1)?_url:_url.substring(0,_url.lastIndexOf("/"))}function showModals(a,b,c){$(".modal.show").each(function(){($(this).data("bs.modal")||{})._isShown&&$(this).modal("hide")}),$("#"+c).find("h2").text(a),$("#"+c).find("p").text(b),$("#"+c).modal("show")}function loadScholarHeader(){loadTemplate("scholarheader",templates.scholarheader,{scholarName:scholar.personalData.name,schoolGrade:scholar.statusQualifications.schoolGrade,program:scholar.scholarship.programName,actLevel:scholar.statusQualifications.schoolLevels[scholar.statusQualifications.schoolLevels.length-1].scholarLevel})}function loadIndex(){loadTemplate("templateInicio",templates.principal,{})}dojo.addOnLoad(function(){var a=getRootPath();dojo.registerModulePath("vistas",a+"fundacionbancomerextranetwebfront/vistas"),dojo.registerModulePath("home",a+"fundacionbancomerextranetwebfront/vistas/home"),dojo.registerModulePath("beca",a+"fundacionbancomerextranetwebfront/vistas/mibeca"),dojo.registerModulePath("calificaciones",a+"fundacionbancomerextranetwebfront/vistas/miscalificaciones"),dojo.registerModulePath("datos",a+"fundacionbancomerextranetwebfront/vistas/misdatos");var b=function(){showModals("Cerrando sesi\xF3n","Espera un momento",SCONFIG.getMessage("wait").idModal),setTimeout(function(){restExec({service:"TERMINATE_SESSION",async:!1,data:{},success:function(){writeLog("se cerr\xF3 sesi\xF3n en back end")},error:function(){writeLog("no se cerr\xF3 sesi\xF3n en back end")}}),$.ajax({type:"GET",dataType:"html",contentType:"application/json; charset=utf-8",url:window.location.origin+"/pkmslogout.form",async:!0,success:function(){$(".index").css({display:"none"}),$("#templateInicio").css({display:"none"}),showModals("Tu sesi\xF3n ha terminado","","savedFile"),$("#savedFile").find("button.btn-primary").click(function(){location.reload()})},error:function(){writeLog("error",data),$("#savedFile").modal("hide")}})},400)};_modal=SCONFIG.getMessage("wait");var c=!1,d=0,e=[function(){return{service:"DETAILS_SCHOLAR",data:{userScholar:ivUser},success:rest_fnDetailsScholar,finallyError:function(){c=!0,$("#"+_modal.idModal).removeAttr("style")}}},function(){return{service:"DEPOSIT_QUERY",data:{userCurrent:scholar.studentID,studentID:scholar.studentID,programType:scholar.scholarship.programType,statusScholarshipReceived:""},success:rest_fnDepositQuery,finallyError:function(){c=!0,$("#"+_modal.idModal).removeAttr("style")}}},function(){return{service:"CONSULT_LEVELGRADE",data:{studentID:scholar.studentID,scholarLevel:""},success:rest_fnConsultLevelGrade,finallySuccess:function(a){writeLog("CONSULT_LEVELGRADE",a)},finallyError:function(){c=!0,$("#"+_modal.idModal).removeAttr("style")}}},function(){return{service:"AVERAGE_QUERY",data:{studentID:scholar.studentID,scholarLevel:"",schoolGrade:""},success:rest_fnAverageQuery,finallySuccess:function(a){writeLog("AVERAGE_QUERY",a)},finallyError:function(){c=!0,$("#"+_modal.idModal).removeAttr("style")}}},function(){return{service:"CONSULT_PARAMETERS",data:{parameterType:"CDRB"},success:rest_fnConsultParameters,finallyError:function(){c=!0,$("#"+_modal.idModal).removeAttr("style")}}},function(){return{service:"GET_ALERTS",data:{userScholar:scholar.personalData.username},error:function(a){console.error("GET_ALERTS",a)},success:rest_fnAlerts}},function(){return{service:"QUALIFICATION_QUERY",data:{studentID:scholar.studentID,scholarLevel:"",schoolGrade:"",schoolPeriod:""},success:rest_fnQualificationQuery,finallyError:function(){hasError=!0,$("#"+_modal.idModal).removeAttr("style")},finallySuccess:function(a){scholar.personalData.profilePicture.trim()&&rest_fnUploadedPhoto({folio:scholar.personalData.profilePicture},!0),writeLog("QUALIFICATION_QUERY",a),loadScholarHeader(),$(".index").removeAttr("style"),$("#"+_modal.idModal).removeAttr("style")}}}];do restExec(e[d]()),d++;while(!c&&d<e.length);$("#secLoading").remove(),c&&$("#"+SCONFIG.getMessage("error").idModal).find("button").on("click",b),$(".exitarea > a").click(function(a){a.preventDefault(),b()}),$("#btnHome").click(function(a){a.preventDefault(),$("#btnMisCalificaciones, #btnMisDatos, #btnMisTutores, #btnMiBeca").removeClass("active"),loadIndex()}),$("#btnMiBeca").click(function(a){a.preventDefault(),$("#btnMiBeca").addClass("active"),$("#btnMisCalificaciones, #btnMisDatos, #btnMisTutores").removeClass("active"),loadTemplate("templateInicio",templates.miBeca,{name:scholar.personalData.name,schoolGrade:scholar.statusQualifications.schoolGrade,program:scholar.scholarship.programName,actLevel:scholar.statusQualifications.schoolLevels[scholar.statusQualifications.schoolLevels.length-1].scholarLevel,status:scholar.scholarship.statusDispersion,programStatus:scholar.program[0].status,program:scholar.scholarship.programName,modality:scholar.scholarship.modalityParticipation,state:scholar.personalData.originState,municipality:scholar.personalData.originMunicipality,region:scholar.personalData.originRegion})}),$("#btnMisCalificaciones").click(function(a){a.preventDefault(),$("#btnMisCalificaciones").addClass("active"),$("#btnMiBeca, #btnMisDatos, #btnMisTutores").removeClass("active"),loadTemplate("templateInicio",templates.misCalificaciones,{name:scholar.personalData.name,schoolGrade:scholar.statusQualifications.schoolGrade,program:scholar.scholarship.programName,actLevel:scholar.statusQualifications.schoolLevels[scholar.statusQualifications.schoolLevels.length-1].scholarLevel})}),$("#btnMisDatos").click(function(a){a.preventDefault();var b=!1,c=0,d=[function(){return{service:"CONSULT_PARAMETERS",data:{parameterType:"SX"},success:rest_fnConsultParameters,finallyError:function(){b=!0}}},function(){return{service:"CONSULT_PARAMETERS",data:{parameterType:"PAREN"},success:rest_fnConsultParameters,finallyError:function(){b=!0}}},function(){return{service:"CONSULT_PARAMETERS",data:{parameterType:"TPVIA"},success:rest_fnConsultParameters,finallyError:function(){b=!0}}},function(){return{service:"GET_STATES",data:{},success:rest_fnStates,finallyError:function(){b=!0},finallySuccess:function(){$("#waitModal").modal("hide")}}}];""!=combos.gender&&""!=combos.typeOfViality&&""!=combos.kindship&&statesTransactions.length?(loadMisDatos(),fn_afterMisDatos(),fn_afterMisDatos=fn_nothing):(showModals("Cargando tu informaci\xF3n","Espera un momento",SCONFIG.getMessage("wait").idModal),setTimeout(function(){do restExec(d[c]()),c++;while(!b&&c<d.length);loadMisDatos(),fn_afterMisDatos(),fn_afterMisDatos=fn_nothing},400))})});